import React from 'react';
import { useNavigate } from "react-router-dom";
import { MapContainer, TileLayer, Polygon } from 'react-leaflet';
import 'leaflet/dist/leaflet.css';

function MapWithPolygon() {
  // Coordinates for the polygon
  const navigate = useNavigate()
  const polygonPositions = [

    [11.0803107555833, 77.00028781059154], [11.07975255273253, 77.00032843956001],[11.079682777301002,77.00144573618769], [11.080292109754183,77.00134679260685], [11.080310755583383,77.00028781059154], [11.0803107555833,77.00028781059154]
  ];

  // Center of the map
  const center = [11.0803107555833, 77.00028781059154];



  function convertJSONCoordinates(data) {
    const result = {};

    for (const key in data) {
        const coordinates = data[key]
            .split(',')
            .map(coord => coord.trim())
            .filter(coord => coord !== '');

        const pairs = [];
        for (let i = 0; i < coordinates.length; i += 2) {
            const lat = parseFloat(coordinates[i]);
            const long = parseFloat(coordinates[i + 1]);
            pairs.push([long, lat]);
        }

        // Add the first pair at the end to complete the loop
        pairs.push([...pairs[0]]);

        result[key] = pairs;
    }

    return result;
}

const coordinatesJSON = { "0": "77.00028781059154, 11.0803107555833,77.00032843956001, ,11.07975255273253,77.00144573618769,11.079682777301002,77.00134679260685,11.080292109754183,77.00028781059154,11.080310755583383",
"1": " 77.00452041210212, 11.084496776167597,77.00438836795456,11.083769129083507,77.0054244066464,11.08368938682672,77.0053329914673,11.084566550450845,77.00452041210212,11.084496776167597",
"2": " 76.9934186841873, 11.079772040758229,76.99345931315577, 11.078276849404446, 76.9947492828984, 11.078246945499288,76.99475944014051,  11.079762072841149, 76.9934186841873, 11.079772040758229",
"3": "76.99641714231325, 11.085738911407148, 76.99642967185031, 11.084829025025314,76.99775780277497, 11.085148715157814, 76.99778286184915, 11.085972530426446,76.99641714231325,11.085738911407148",
"4": "76.99432476243982,11.089931685445734,76.99445005780922, 11.088468509375602,76.99478835530886,11.088370144335272, 76.99496376882655,11.089882503175488, 76.99432476243982,11.089931685445734",
"5": "76.9946927636567, 11.09667857516699, 76.9946927636567,  11.096432669412238,76.99466770458258,11.09633430705182,  76.9962088376347,  11.096383488236171,76.99607101272824, 11.09676464213203,  76.9946927636567,11.09667857516699",
"6": "76.9997045611948,11.097649899465267,76.99980479749001, 11.095842493345046, 76.99981732702707, 11.09549822424529, 77.00058162878605,11.095461338246011,77.00085727860039,11.097613013737686,76.99970456119485,11.097649899465267",
"7": "77.00444126689388, 11.084353755316911, 77.00435356013435,   11.083861922862141, 77.00452897365346, 11.08356682299241,77.0050928028192,11.083603710492582, 77.00545615939154, 11.083886514504641,77.00548121846577,11.084513600686606,77.00498003698544, 11.084673445968235,77.00444126689388, 11.084353755316911",
"8": "77.0093752126366, 11.093579937415996,77.0087644552961, 11.091907174075047,  77.00939048156653,  11.091607499773957, 77.01114640890643, 11.092776227811143,77.0093752126366, 11.093579937415996",
"9": " 76.98488408934696,11.088820466145293, 76.98491462721381, 11.087127284428178,76.9871744293547,11.087202204180016, 76.98725077402207, 11.089899302478969,76.98488408934696,11.088820466145293",
"10": "76.95470796432221,11.083404727374514;76.95962061383432,11.083475107230484;76.95978197823428,11.088049761491632;76.95418801236644,11.087469136262285;76.95470796432221,11.083404727374514",
"11": "76.94807423465522,11.086651314264344;76.9521332978025,11.087256776885923;76.9515487927095,11.08900942477544;76.95089934260545,11.089232488297696;76.95057461755499,11.091367516264327;76.94761961958267,11.090411535521113;76.94807423465522,11.086651314264344",
"12": "76.95842440495812,11.092065889094428;76.9622418576746,11.09257212380264;76.96148524542485,11.098849361312318;76.95718631218392,11.096655718374095;76.95842440495812,11.092065889094428",
"13": "76.97213704820581,11.112032041205424;76.96808342179213,11.111440987169317;76.96622754463829,11.11024290098976;76.96700896659792,11.107191752635572;76.97234868332043,11.108453749802706;76.97213704820581,11.112032041205424",
"14": "76.98668612095469,11.107305917869922;76.98703482012331,11.10448302338574;76.98848773332804,11.104540051827243;76.9899115882697,11.105880216997505;76.990957685777,11.10744848757426;76.98668612095469,11.107305917869922",
"15": "77.03402621740094,11.102528993558494;77.03370926600945,11.098263553743195;77.03855409442195,11.09804139371252;77.03918799720492,11.102351268143764;77.03402621740094,11.102528993558494",
"16": "77.0369752192334,11.083578537766329;77.03705289198905,11.082907765897176;77.03643150993969,11.08275531753037;77.03650918269528,11.081749156317343;77.03568585147895,11.081596707346733;77.03562371327325,11.081246074413002;77.03681987372073,11.081398523566392;77.04090546070273,11.082313216817411;77.03899471089733,11.084096860430378;77.0369752192334,11.083578537766329",
"17": "77.0385870460874,11.086010845338862;77.0408735630844,11.08586450727364;77.04082385619267,11.09444954984123;77.03888528743431,11.094156882087887;77.03799056339221,11.089132706609604;77.0385870460874,11.086010845338862",
"18": "76.98501659037203,11.069242064150217;76.98490136152623,11.070900641106846;76.98313451924173,11.070674472074558;76.98313451924173,11.069958268988174;76.98203984521729,11.069769794200539;76.98211666444786,11.069091283961427;76.98405634999926,11.068789723351017;76.98501659037203,11.069242064150217",
"19": "76.99248551127835,11.064241013508024;76.99374658020633,11.06408220266782;76.99386933912865,11.06538006804486;76.99244087167091,11.065177448090878;76.99248551127835,11.064241013508024"
}
const convertedCoordinates = convertJSONCoordinates(coordinatesJSON);
console.log(convertedCoordinates);

const handleClick = (e) => {
  console.log('Polygon clicked!', e);
  navigate('/analytics');
};

  return (
    <MapContainer center={center} zoom={13} style={{ height: '90vh', width: '100%' }}>
      <TileLayer
        url="https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png"
      />
      <Polygon positions={polygonPositions} pathOptions={{ color: 'blue' }} eventHandlers={{click: handleClick}} />
      {/* <Polygon positions={convertedCoordinates} pathOptions={{ color: 'blue' }} /> */}
    </MapContainer>
  );
}

export default MapWithPolygon;
